<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" 
	xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools" 
	xmlns="http://www.mulesoft.org/schema/mule/core" 
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" 
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
		
	<munit:config name="policy-details-endpoint-test.xml" />
	
	<munit:test name="test-get-policy-details-success" doc:id="a1b2c3d4-e5f6-7890-1234-567890abcdef" description="Test successful policy details retrieval">
		<munit:behavior >
			<set-variable value="POL123456" doc:name="Set Policy ID" doc:id="b2c3d4e5-f6g7-8901-2345-678901bcdefg" variableName="policyId"/>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="get-policy-details-impl" doc:id="c3d4e5f6-g7h8-9012-3456-789012cdefgh" name="get-policy-details-impl"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert payload is not null" doc:id="d4e5f6g7-h8i9-0123-4567-890123defghi" expression="#[payload]" is="#[MunitTools::notNullValue()]"/>
			<munit-tools:assert-that doc:name="Assert has policyId" doc:id="e5f6g7h8-i9j0-1234-5678-901234efghij" expression="#[payload.policyId]" is="#[MunitTools::equalTo('POL123456')]"/>
		</munit:validation>
	</munit:test>
	
	<munit:test name="test-get-policy-details-invalid-id" doc:id="f6g7h8i9-j0k1-2345-6789-012345fghijk" description="Test with invalid policy ID">
		<munit:behavior >
			<set-variable value="" doc:name="Set Empty Policy ID" doc:id="g7h8i9j0-k1l2-3456-7890-123456ghijkl" variableName="policyId"/>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="get-policy-details-impl" doc:id="h8i9j0k1-l2m3-4567-8901-234567hijklm" name="get-policy-details-impl"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert error response" doc:id="i9j0k1l2-m3n4-5678-9012-345678ijklmn" expression="#[payload.error]" is="#[MunitTools::equalTo('Policy ID is required')]"/>
			<munit-tools:assert-that doc:name="Assert HTTP status is 400" doc:id="j0k1l2m3-n4o5-6789-0123-456789jklmno" expression="#[vars.httpStatus]" is="#[MunitTools::equalTo(400)]"/>
		</munit:validation>
	</munit:test>
	
</mule>